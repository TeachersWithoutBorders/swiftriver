go back to the <%= link_to "#votereport homepage", reports_path %>
<div id="map"></div>

	<!-- <script src="http://openlayers.org/api/2.6/OpenLayers.js"></script> -->
    <script src="http://maps.google.com/maps?file=api&v=2&key=<%=GMAPS_API_KEY%>" type="text/javascript"></script>
    <script type="text/javascript" src="/javascripts/mapstraction.js"></script>	
    <script type="text/javascript" src="/javascripts/mapping.js"></script>	
	<script type="text/javascript" src="/javascripts/jquery.min.js"></script>	
    <style type="text/css">
        #map {
            width: 100%;
            height: 80%;
            border: 1px solid gray;
        }
    </style>

<ul class="controls">
	<li><em>Filter:</em></li>
	<li><a href="#" onclick="return updateMap('count=100')">Last 100 reports</a></li>
	<li><a href="#" onclick="return updateMap('wait_time=90')">Wait time > 90 minutes</a></li>
	<li><a href="#" onclick="return updateMap('rating=30')">Bad rating</a></li>
</ul>
<ul class="legend">
	<li><strong>Map Legend</strong></li>
	<li><%= image_tag "rating_bad.png" %> - Bad rating (0-30)</li>
	<li><%= image_tag "rating_medium.png" %> - Medium rating (31-70)</li>
	<li><%= image_tag "rating_good.png" %> - Good rating (71-100)</li>		
</ul>
<div id="update_status" style="display:none">updating...</div>
<a href="#" onclick="updateMap('last_updated='+last_updated +'&'+filters); return false">Update Map</a>
updated: <span id="last_updated"></span>

<script type="text/javascript" charset="utf-8">

		$(document).ready(function() {
			initMapJS();
			filters = "<%= @filters.collect{|k,v| "#{k}=#{v}"}.join("&") %>";
			state = "<%= @filters[:state] || '' %>";
			remoteLoad("/reports.json?callback=loadMarkers&per_page=200&" + filters)
		 });
</script>